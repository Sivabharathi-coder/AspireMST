<script>
    const request = indexedDB.open("MyDB", 1);

    request.onupgradeneeded = function (event) {
        const db = event.target.result;
        db.createObjectStore("users", { keyPath: "id" });
        console.log("Upgrade needed: object store created");
    };

    request.onsuccess = function (event) {
        const db = event.target.result;
        console.log("Database opened successfully");
    };

    request.onerror = function () {
        console.error("Error opening database");
    };

    request.onblocked = function () {
        console.warn("Upgrade blocked. Please close other tabs using DB.");
    };


    // IDBDatabase 

    request.onsuccess = function (event) {
        const db = event.target.result;

        db.onerror = function (e) {
            console.error("Database error: ", e.target.error);
        };

        db.onversionchange = function () {
            db.close();
            alert("A new version is ready. Please reload the page.");
        };

        db.onabort = function () {
            console.warn("Transaction was aborted");
        };
    };


    // IDBRequest 

    const transaction = db.transaction("users", "readwrite");
    const store = transaction.objectStore("users");

    const addUser = store.add({ id: 1, name: "Siva" });

    addUser.onsuccess = () => {
        console.log("User added");
    };

    addUser.onerror = () => {
        console.error("Failed to add user");
    };


    // IDBTransaction 


    transaction.oncomplete = () => {
        console.log("Transaction completed");
    };

    transaction.onerror = () => {
        console.error("Transaction error");
    };

    transaction.onabort = () => {
        console.warn("Transaction aborted");
    };

    store.add({ id: 2, name: "John" });


</script>

